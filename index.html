<!doctype html>
<html lang="en-US">
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge" >
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
	<meta name="description" content="The PHP-WVL Raffler is a tool to randomly select 1 person from the list of commenters of an event on Joind.IN" />

	<link rel="stylesheet" href="css/screen.css"/>
	<link href='http://fonts.googleapis.com/css?family=Hammersmith+One' rel='stylesheet' type='text/css'>

	<script src="js/modernizr.min.js"></script>

	<title>PHP-WVL Raffler</title>
</head>
<body>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
    <script src="js/handlebars-v2.0.0.js"></script>
    <script src="js/meetup.js"></script>
    <script src="js/joindin.js"></script>
    <script src="js/raffler.js"></script>
	<script id="raffler-eventlist" type="text/x-handlebars-template">
		<table class="table">
			<thead>
				<tr>
					<th>{{translate 'Event name'}}</th>
					<th>&nbsp;</th>
				</tr>
			</thead>
			<tbody>
			{{#each events}}
				<tr>
					<td>{{this.name}}</td>
					<td>
						<button type="button" class="{{this.btnClass}} btn btn-default btn-xs" id="search-result-{{this.id}}">
							<span class="glyphicon glyphicon-thumbs-up"></span>
						</button>
					</td>
				</tr>
			{{/each}}
			</tbody>
		</table>
	</script>
	<script id="raffler-loaderLeft" type="text/x-handlebars-template">
		<div class="col-sm-1">
			<img src="{{path}}" title="{{translate 'Loading...'}}" alt="loader image" />
		</div>
		<div class="col-sm-11">{{text}}</div>
	</script>
	<script id="raffler-loaderRight" type="text/x-handlebars-template">
		<div class="col-sm-11">{{text}}</div>
		<div class="col-sm-1">
			<img src="{{path}}" title="{{translate 'Loading...'}}" alt="loader image" />
		</div>
	</script>
    <script type="text/javascript">
        $(function(){
			var joindIn = new JoindIN();
			var raffler = new Raffler(joindIn);
        });
    </script>
    <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
         })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

       ga('create', 'UA-50375074-2', 'auto');
       ga('send', 'pageview');

    </script>
	<header>
		<div id="navbar">

		</div>
		<div id="logo">
			<h1>
				PHP-WVL
			</h1>
		</div>
	</header>
	<div id="content">
		<h2>PHP-WVL Joind.in Raffler</h2>
		<p>
			Randomly selects 1 person who took the effort of providing feedback to the given Joind.in event.
		</p>
		<div id="msgPane" style="padding:0 10px;margin-bottom:15px;"></div>
		<form id="frmRaffle" class="form-inline" role="form">
			<div class="form-group">
				<label for="inputEventID" class="control-label">Event ID</label>
				<input type="text" class="form-control" id="inputEventID" placeholder="e.g. 2177">
			</div>
			<div class="form-group">
				<button type="submit" class="btn btn-primary" id="btnRaffle">Raffle!</button>
				<button type="button" class="btn btn-small btn-default" id="btnSearch">
					<span class="glyphicon glyphicon-search"></span>
				</button>
			</div>
		</form>
		<form id="frmSearch" class="form-inline" role="form">
			<div class="form-group">
				<label for="inputQuery" class="control-label">Event name</label>
				<input type="text" class="form-control" id="inputQuery" placeholder="e.g. WVL">
			</div>
			<div class="form-group">
				<button type="submit" class="btn btn-primary" id="btnSearchSubmit">Search</button>
				<button type="button" class="btn btn-link" id="btnSearchCancel">Cancel</button>
			</div>
		</form>
		<p><a href="rules" class="load">rules</a></p>
	</div>
	<footer>
		&copy; PHP-WVL
	</footer>

	<script>
		var defaultContent = '';

		var loadPage = function(page, push = true) {
			if (push) history.pushState(page ,'','#' + page);

			$('#content').empty();

			if (page == 'home') $('#content').append(defaultContent);
			else $('#content').load(page + ".html");
		}

		$(function() {
			defaultContent = ($('#content').html());

			hash = window.location.hash.substring(1);
			if (hash != '') loadPage(hash);
			else history.pushState('home','null','');
			
			$('#content').on('click', 'a.load', function(e) {
				e.preventDefault();
				loadPage($(this).attr('href'));
			});
		});

		$(window).on('popstate', function(e) {
		    if (e.originalEvent.state && e.originalEvent.state) {
		        loadPage(e.originalEvent.state,false)
		    }
		});
	</script>
</body>
</html>
